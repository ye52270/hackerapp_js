{"mappings":"AAAA,MAAM,YAAgC,SAAS,cAAc,CAAC;AAC9D,MAAM,WAAW;AACjB,MAAM,cAAc;AACpB,MAAM,OAAuB,IAAI;AAgCjC,MAAM,QAAe;IACnB,aAAa;IACb,WAAW;IACX,aAAa;IACb,OAAO,EAAE;AACX;AAEA,SAAS,QAAW,MAAc,EAAE,GAAW,EAAE,SAAkB,KAAK,EAAK;IAC3E,QAAQ,GAAG,CAAC;IAEZ,KAAK,IAAI,CAAC,QAAQ,KAAK;IACvB,KAAK,IAAI;IAET,OAAO,KAAK,KAAK,CAAC,KAAK,QAAQ;AACjC;AAEA,SAAS,SAAS,KAAiB,EAAc;IAC/C,IAAK,IAAI,IAAI,GAAG,IAAI,MAAM,MAAM,EAAE,IAChC,KAAK,CAAC,EAAE,CAAC,IAAI,GAAG,KAAK;IAEvB,OAAO;AACT;AAEA,SAAS,WAAW,QAAgB,EAAQ;IAC1C,aAAa,IAAI,GAAI,UAAU,SAAS,GAAG,WAAY,QAAQ,KAAK,CAAC,QAAQ;AAC/E;AAEA,uDAAuD;AACvD,SAAS,WAAiB;IACxB,IAAI,WAAuB,MAAM,KAAK;IACtC,MAAM,WAAW,EAAE;IACnB,MAAM,YAAY,SAAS,MAAM,GAAG,MAAM,WAAW;IAErD,IAAI,CAAC,SAAS,MAAM,EAClB,WAAW,MAAM,KAAK,GAAG,SAAS,QAAoB,OAAO;IAG/D,IAAI,WAAW,CAAC;;;;;;;;;;;;;;;;;;;;;;;EAuBhB,CAAC;IAED,IACE,IAAI,IAAI,AAAC,CAAA,MAAM,WAAW,GAAG,CAAA,IAAK,MAAM,WAAW,EACnD,IAAI,MAAM,WAAW,GAAG,MAAM,WAAW,IAAI,IAAI,SAAS,MAAM,EAChE,IAEA,SAAS,IAAI,CAAC,CAAC;uBACI,EACf,QAAQ,CAAC,EAAE,CAAC,IAAI,GAAG,gBAAgB,UAAU,CAC9C;;;0BAGmB,EAAE,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;;;yEAGQ,EAC7D,QAAQ,CAAC,EAAE,CAAC,cAAc,CAC3B;;;;;+CAKoC,EAAE,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDAClB,EAAE,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;gDACrB,EAAE,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;;;;IAInE,CAAC;IAGH,WAAW,SAAS,OAAO,CAAC,qBAAqB,SAAS,IAAI,CAAC;IAC/D,WAAW,SAAS,OAAO,CACzB,qBACA,OAAO,MAAM,WAAW,GAAG,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC;IAE1D,WAAW,SAAS,OAAO,CACzB,qBACA,OACE,MAAM,WAAW,GAAG,YAAY,MAAM,WAAW,GAAG,IAAI,MAAM,WAAW;IAI7E,WAAW;AACb;AAEA,yDAAyD;AACzD,SAAS,aAAa;IACpB,MAAM,KAAK,SAAS,IAAI,CAAC,OAAO,CAAC,WAAW;IAC5C,MAAM,cAAc,QAClB,OACA,YAAY,OAAO,CAAC,OAAO;IAG7B,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,OAAmB;QACnC,IAAI,KAAK,EAAE,KAAK,OAAO,KAAK;YAC1B,KAAK,IAAI,GAAG,IAAI;YAChB,QAAQ,GAAG,CAAC,CAAC,UAAU,EAAE,OAAO,KAAK,EAAE,CAAC,QAAQ,EAAE,OAAO,GAAG,CAAC;QAC/D,CAAC;IACH;IAEA,yCAAyC;IACzC,mCAAmC;IACnC,MAAM;IAEN,IAAI,WAAW,CAAC;;;;;;;;;4BASU,EAAE,MAAM,WAAW,CAAC;;;;;;;;;UAStC,EAAE,YAAY,KAAK,CAAC;;QAEtB,EAAE,YAAY,OAAO,CAAC;;;;;;;AAO9B,CAAC;IAEC,WACE,SAAS,OAAO,CAAC,oBAAoB,YAAY,YAAY,QAAQ;AAEzE;AAEA,SAAS,YAAY,QAAuB,EAAU;IACpD,MAAM,gBAAgB,EAAE;IAExB,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,MAAM,EAAE,IAAK;QACxC,MAAM,EAAE,MAAK,EAAE,KAAI,EAAE,SAAQ,EAAE,QAAO,EAAE,GAAG,QAAQ,CAAC,EAAE;QACtD,cAAc,IAAI,CAAC,CAAC;gCACQ,EAAE,QAAQ,GAAG;;;gBAG7B,EAAE,KAAK,UAAU,EAAE,SAAS;;+BAEb,EAAE,QAAQ;;EAEvC,CAAC;QAEC,IAAI,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,GAAG,GAChC,cAAc,IAAI,CAAC,YAAY,QAAQ,CAAC,EAAE,CAAC,QAAQ;IAEvD;IACA,OAAO,cAAc,IAAI,CAAC;AAC5B;AAEA,SAAS,SAAS;IAChB,MAAM,YAA2B,SAAS,IAAI;IAC9C,MAAM,SAAiB;IAEvB,IAAI,cAAc,IAChB;SACK,IAAI,UAAU,OAAO,CAAC,cAAc,GAAG;QAC5C,MAAM,WAAW,GAAG,OAAO,UAAU,KAAK,CAAC,OAAO,CAAC,EAAE;QACrD;IACF,OACE;AAEJ;AAEA,OAAO,gBAAgB,CAAC,cAAc;AACtC","sources":["app.ts"],"sourcesContent":["const container: HTMLElement | null = document.getElementById(\"root\");\nconst NEWS_URL = \"https://api.hnpwa.com/v0/news/1.json\";\nconst CONTENT_URL = \"https://api.hnpwa.com/v0/item/@id.json\";\nconst ajax: XMLHttpRequest = new XMLHttpRequest();\n\ninterface Store {\n  currentPage: number;\n  totalPage: number;\n  pagingCount: number;\n  feeds: NewsFeed[];\n}\n\ninterface News {\n  id: number;\n  time_ago: string;\n  title: string;\n  url: string;\n  user: string;\n  content: string;\n}\ninterface NewsFeed extends News {\n  comments_count: number;\n  points: number;\n  read?: boolean;\n}\n\ninterface NewsDetail extends News {\n  comments: [];\n}\n\ninterface NewsComment extends News {\n  comments: [];\n  level: number;\n}\n\nconst store: Store = {\n  currentPage: 1,\n  totalPage: 0,\n  pagingCount: 8,\n  feeds: [],\n};\n\nfunction getData<T>(method: string, url: string, option: boolean = false): T {\n  console.log(url);\n\n  ajax.open(method, url, option);\n  ajax.send();\n\n  return JSON.parse(ajax.response);\n}\n\nfunction makeFeed(feeds: NewsFeed[]): NewsFeed[] {\n  for (let i = 0; i < feeds.length; i++) {\n    feeds[i].read = false;\n  }\n  return feeds;\n}\n\nfunction updateView(template: string): void {\n  container != null ? (container.innerHTML = template) : console.error(\"error\");\n}\n\n// -----------------------------------------  News Feed\nfunction newsFeed(): void {\n  let newsFeed: NewsFeed[] = store.feeds;\n  const newsList = [];\n  const totalPage = newsFeed.length / store.pagingCount;\n\n  if (!newsFeed.length) {\n    newsFeed = store.feeds = makeFeed(getData<NewsFeed[]>(\"GET\", NEWS_URL));\n  }\n\n  let template = `\n  <div class=\"bg-gray-600 min-h-screen\">\n  <div class=\"bg-white text-xl\">\n    <div class=\"mx-auto px-4\">\n      <div class=\"flex justify-between items-center py-6\">\n        <div class=\"flex justify-start\">\n          <h1 class=\"font-extrabold\">Hacker News</h1>\n        </div>\n        <div class=\"items-center justify-end\">\n          <a href=\"#/page/{{__prev_page__}}\" class=\"text-gray-500\">\n            Previous\n          </a>\n          <a href=\"#/page/{{__next_page__}}\" class=\"text-gray-500 ml-4\">\n            Next\n          </a>\n        </div>\n      </div> \n    </div>\n  </div>\n  <div class=\"p-4 text-2xl text-gray-700\">\n    {{__news_feed__}}        \n  </div>\n</div>\n  `;\n\n  for (\n    let i = (store.currentPage - 1) * store.pagingCount;\n    i < store.currentPage * store.pagingCount && i < newsFeed.length;\n    i++\n  ) {\n    newsList.push(`\n      <div  class=\"p-6 ${\n        newsFeed[i].read ? \"bg-gray-300\" : \"bg-white\"\n      } mt-6 rounded-lg shadow-md transition-colors duration-500 hover:bg-green-100\">\n      <div class=\"flex\">\n        <div class=\"flex-auto\">\n          <a href=\"#/show/${newsFeed[i].id}\">${newsFeed[i].title}</a>  \n        </div>\n        <div class=\"text-center text-sm\">\n          <div class=\"w-10 text-white bg-green-300 rounded-lg px-0 py-2\">${\n            newsFeed[i].comments_count\n          }</div>\n        </div>\n      </div>\n      <div class=\"flex mt-3\">\n        <div class=\"grid grid-cols-3 text-sm text-gray-500\">\n          <div><i class=\"fas fa-user mr-1\"></i>${newsFeed[i].user}</div>\n          <div><i class=\"fas fa-heart mr-1\"></i>${newsFeed[i].points}</div>\n          <div><i class=\"far fa-clock mr-1\"></i>${newsFeed[i].time_ago}</div>\n        </div>  \n      </div>\n    </div>    \n    `);\n  }\n\n  template = template.replace(\"{{__news_feed__}}\", newsList.join(\"\"));\n  template = template.replace(\n    \"{{__prev_page__}}\",\n    String(store.currentPage > 1 ? store.currentPage - 1 : 1)\n  );\n  template = template.replace(\n    \"{{__next_page__}}\",\n    String(\n      store.currentPage < totalPage ? store.currentPage + 1 : store.currentPage\n    )\n  );\n\n  updateView(template);\n}\n\n// -----------------------------------------  News Detail\nfunction newsDetail() {\n  const id = location.hash.replace(\"#/show/\", \"\");\n  const newsContent = getData<NewsDetail>(\n    \"GET\",\n    CONTENT_URL.replace(\"@id\", id)\n  );\n\n  store.feeds.find((feed: NewsFeed) => {\n    if (feed.id === Number(id)) {\n      feed.read = true;\n      console.log(`feed.id = ${typeof feed.id} , id = ${typeof id}`);\n    }\n  });\n\n  // store.feeds.forEach((feed, index) => {\n  //   console.log(index, feed.read);\n  // });\n\n  let template = `\n    <div class=\"bg-gray-600 min-h-screen pb-8\">\n    <div class=\"bg-white text-xl\">\n      <div class=\"mx-auto px-4\">\n        <div class=\"flex justify-between items-center py-6\">\n          <div class=\"flex justify-start\">\n            <h1 class=\"font-extrabold\">Hacker News</h1>\n          </div>\n          <div class=\"items-center justify-end\">\n            <a href=\"#/page/${store.currentPage}\" class=\"text-gray-500\">\n              <i class=\"fa fa-times\"></i>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"h-full border rounded-xl bg-white m-6 p-4 \">\n      <h2>${newsContent.title}</h2>\n      <div class=\"text-gray-400 h-20\">\n        ${newsContent.content}\n      </div>\n\n      {{__comments__}}\n\n    </div>\n  </div>\n`;\n\n  updateView(\n    template.replace(\"{{__comments__}}\", makeComment(newsContent.comments))\n  );\n}\n\nfunction makeComment(comments: NewsComment[]): string {\n  const commentString = [];\n\n  for (let i = 0; i < comments.length; i++) {\n    const { level, user, time_ago, content } = comments[i];\n    commentString.push(`\n      <div style=\"padding-left: ${level * 40}px;\" class=\"mt-4\">\n      <div class=\"text-gray-400\">\n        <i class=\"fa fa-sort-up mr-2\"></i>\n        <strong>${user}</strong> ${time_ago} \n      </div>\n      <p class=\"text-gray-700\">${content}</p>\n    </div>      \n  `);\n\n    if (comments[i].comments.length > 0) {\n      commentString.push(makeComment(comments[i].comments));\n    }\n  }\n  return commentString.join(\"\");\n}\n\nfunction router() {\n  const routePath: string | null = location.hash;\n  const regExp: RegExp = /[0-9]/gi;\n\n  if (routePath === \"\") {\n    newsFeed();\n  } else if (routePath.indexOf(\"#/page/\") >= 0) {\n    store.currentPage = Number(routePath.match(regExp)[0]);\n    newsFeed();\n  } else {\n    newsDetail();\n  }\n}\n\nwindow.addEventListener(\"hashchange\", router);\nrouter();\n"],"names":[],"version":3,"file":"index.6b86260e.js.map","sourceRoot":"/__parcel_source_root/"}